<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Home Temperature</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel='shortcut icon' type='image/x-icon' href='favicon.ico' />
  <style type="text/css">
    body {
        background-color: #292929 !important;
        color: #ffffff;
        font-family: Arial, sans-serif;
        padding-top: 5px;
        text-align: center;
        max-width: 600px;
    }

    .navbar {
        background-color: #343a40 !important;
        padding: 150px;
    }

    .navbar-brand, .navbar-nav .nav-link {
        color: #ffffff !important;
    }

    .panel {
        background: #3a3a3a;
        border-radius: 10px;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.5);
        margin-top: 20px;
        padding: 15px;
        
    }

    .panel-heading {
        background: #1976d2;
        color: white;
        padding: 5px;
        border-radius: 10px;
        font-weight: bold;
        font-size: 18px;
    }

    .panel-body {
        padding: 5px;
        border: #292929;
    }

  
    .container {
        max-width: 600px;
        padding: 5px;
    }


  </style>

  <!-- Font Awesome -->
     <!-- Bootstrap 5 -->
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
</head>

<body>
  <nav class="navbar navbar-dark">
    <div class="container">
      <a class="navbar-brand " href="#">AC Control</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="btn btn-success" href="/upload.html" style="width: 100%; margin: 5px 0;">
              <i class="fas fa-upload"></i> File Upload
            </a>
          </li>
          <li class="nav-item">
            <a class="btn btn-warning" href="/settings.html" style="width: 100%; margin: 5px 0;">
              <i class="glyphicon glyphicon-cog"></i> Settings
            </a>
          </li>
          <li class="nav-item">
            <a class="btn btn-danger" href="/reset" style="width: 100%; margin: 5px 0;">
              <i class="glyphicon glyphicon-repeat"></i> Reset
            </a>
          </li>
          <li class="nav-item">
            <a class="btn btn-primary" onclick="window.location.reload(true);" style="width: 100%; margin: 5px 0;">
              <i class="glyphicon glyphicon-refresh"></i> Refresh
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container mt-0 text-center">
   

    <div class="panel  text-center mt-2">
      <div class="d-grid d-md-flex justify-content-md-end mx-auto ">
        <a id="power-btn" class="btn btn-secondary btn-lg" onclick="power_onclick(); " style="width: 140px; border-color: rgb(255, 0, 0);">
          <i class="fa fa-power-off"></i>
          <b  id="power"> OFF</b>
        </a>
      </div>
      <div class="panel-heading mt-2">Sensors</div>
      <div class="panel-body">
        <div class="row">
          <div class="col-6" id="target_temp_col">
               <div class="btn-group">
                   <a class="btn btn-outline-info rounded " >
                      <div class="row">
                          
                            <span class="col-md-12 col-sm-12">Sıcaklık</span>
                            <h1><span class="badge bg-info  mt-2 text-black" id="temperature">--</span>
                           </h1>
                      </div>
                        <div class="row">
                        
                        <span class="col-md-12 col-sm-12">Nem</span>
                        <h1><span class="badge bg-info  mt-2 text-black" id="humidity">--</span>
                        </h1>
                        </div>
                   </a>
                </div>
              
          </div>
              <div class="col-6 " id="air_quality_col">
              <div class="btn-group">
            
              <a class="btn btn-outline-success" >
                <div class="row">
                  <span class="col-md-12 col-sm-12">Hava Kalitesi</span><br>
                  <h1><span class="badge bg-info col-md-12 col-sm-12 text-black mt-2" id="air_quality">--</span><br>
                    <span class="badge bg-info col-md-12 col-sm-12 text-black mt-2" id="quality">--</span>
                  </h1>
                </div>
              </a>
            
          </div>
        </div> </div>
        
        <div class="panel-heading mt-2">OTOMASYON AYARLARI</div>
        <div class="col-6 " id="air_quality_col">
          <div class="btn-group">
        
          <a class="btn btn-outline-success" >
            <div class="row">
              <span class="col-md-12 col-sm-12">Mod</span><br>
              <h1>
                <span class="badge bg-info col-md-12 col-sm-12 text-black mt-2" id="mode">--</span>
              </h1>
            </div>
          </a>
        
      </div>
    </div> 
      <div class="panel-heading mt-2">AC Temperature</div>
      
      <div class="btn-group mt-2 ">
        <a class="input-group-text col-12 text-center d-grid" style="font-size:3em; background-color: darkorange; width: 300px;" >
         
          <b id="target_temp">~ °C</b> 
        </a>
      
      <div class="btn-group-vertical gap-4  input-group-text">
        <a class="btn btn-secondary  me-4" id="target_temp_up" onclick="temp_onclick(1);" style="border-color: rgb(12, 12, 12);">
          <i class="fa fa-chevron-up"></i>
        </a>
        <a class="btn btn-secondary  me-4" id="target_temp_down" onclick="temp_onclick(-1);" style="border-color: rgb(12, 12, 12);">
          <i class="fa fa-chevron-down"></i>
        </a>
      </div>
    
      </div>
    <div class="row">
      
        <div class="panel-heading mt-2">Mode</div>
        <div class="col-md-12 mt-2">
        <div class="btn-group btn-group-lg">
          <a class="btn btn-secondary mode-btn" id="mode_cooling" onclick="mode_onclick(1);"><i class="fa fa-asterisk"></i></a>
          <a class="btn btn-secondary mode-btn" id="mode_dehum" onclick="mode_onclick(2);"><i class="fa fa-tint"></i></a>
          <a class="btn btn-secondary mode-btn" id="mode_heating" onclick="mode_onclick(3);"><i class="fas fa-sun"></i></a>
          <a class="btn btn-secondary mode-btn" id="mode_fan" onclick="mode_onclick(4);"><i class="fa fa-retweet"></i></a>
          <a class="btn btn-secondary mode-btn" id="mode_auto" onclick="mode_onclick(0);"><i class="fa fa-font"></i></a>
        </div>
      </div></div>
     
      
      
        <div class="panel-heading mt-2">Fan Speed</div>
        <div class="col-md-12 mt-2"></div>
        <div class="btn-group btn-group-lg">
          <a class="btn btn-secondary fan-btn" id="fan_auto" onclick="fan_onclick('0');"><i class="fa fa-font"></i></a>
          <a class="btn btn-secondary" onclick="fan_onclick(1);"><img src="level_1_off.svg" height="29px" id="fan_lvl_1"></a>
          <a class="btn btn-secondary" onclick="fan_onclick(2);"><img src="level_2_off.svg" height="29px" id="fan_lvl_2"></a>
          <a class="btn btn-secondary" onclick="fan_onclick(3);"><img src="level_3_off.svg" height="29px" id="fan_lvl_3"></a>
        </div>
      </div>
    </div>
  </div>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="ui.js"></script>
  <script>
    async function fetchDHTData() {
      const response = await fetch('/dht');
      const data = await response.json();
      document.getElementById('temperature').innerText = data.temperature + ' °C';
      document.getElementById('humidity').innerText = '% ' + data.humidity;
      document.getElementById('air_quality').innerText = data.airQuality + ' AQI';
      document.getElementById('quality').innerText = data.Quality;
    }
    setInterval(fetchDHTData, 5000);
    window.onload = fetchDHTData;
  </script>
    <script>
      // Sayfa yüklendiğinde ayarları çek ve forma uygula
      window.addEventListener('DOMContentLoaded', () => {
        fetch('/get_config')
          .then(res => res.json())
          .then(data => {
            
            document.getElementById('mode').value = data.mode|| '';
            document.getElementById('roomTemp').value = data.roomTemp || '';
            document.getElementById('nodeIp').value = data.nodeIp || '';
            document.getElementById('apiUrl').value = data.apiUrl || '';
            document.getElementById('command_on').value = data.command_on || '';
            document.getElementById('command_off').value = data.command_off || '';
          })
          .catch(err => {
            document.getElementById('status').innerText = 'Ayarlar yüklenemedi!';
            console.error(err);
          });
      });
    </script>
</body>
</html>
